# Start Here

`Name`: Austin Cook
`NetID`: ac898

For each problem below, you will,

1. List the steps necessary to execute the exploit.
2. An explanation of what the vulnerability was.
3. An explanation of how you would patch the vulnerability.
4. If the challenge had a patch portion, enter the code used to patch the challenge.

--

## Scoreboard

### Steps

1. Press the `F12` key
2. Click on the `Sources` tab
3. Search `/s` as the beginning of sources
4. Note that `/score-board` is a defined constant
5. Add `/score-board` to the url (the full url is `http://localhost:3000/#/score-board`)

---

## DOM XSS

### Exploit steps

1. Click on the search bar at the top of the screen
2. Enter the malicious code `<iframe src="javascript:alert(`xss`)">`

- Note: To exploit this, I also tried several input areas, but found that the vulnerability was located in the search bar.

### Explanation

The vulnerability is that there is no input validation in the search bar. When a user types in an item to search, and presses enter, you can inspect the HTML of the resulting page under the 'Elements' tab of developer tools. It contains the following:

`<span ... id="searchValue"><iframe src="javascript:alert('xss')">...</iframe></span>`

The input was not validaded, and the 'iframe' tax was treated as valid HTML, and because of this, its Javascript was able to be executed.

### Patch

There are a couple of ways you could go about this. If you were writing a website in plain HTML and JavaScript, and didn't have a library or framework with added security features, you could use HTML and Javascript encoding with the 'node-esapi' encoder package. However, this code uses the Angular web development framework, which I learned that it has security built in by default. This means that it should be validating input automatically, and that something must have been turned of. In the patch section that follows, I reveal where this vulnerability takes place (we are wrongly bypassing Angular security and trusting the text without validation).

### Patch code

```
6	-	      this.searchValue = this.sanitizer.bypassSecurityTrustHtml(queryParam)
6	+	      this.searchValue = queryParam
```

---

## Reflected XSS

### Exploit steps

1. List your (exact) steps here

### Explanation

In your own words, write a couple sentences about why this code is vulnerable. _(Keep to 200 words or less; preferably much less.)_

### Patch

In your own words, explain how would patch this vulnerability. _(Keep to 200 words or less; preferably much less.)_

### Patch code

Not applicable

---

## Forged Review

### Exploit steps

1. Create a review while logged in with an attacker account
2. Press `Submit` to submit the review
3. Open developer tools with `F12`
4. Click on the `Network` tab
5. Right click on the most recent packet titled `Reviews`
6. Under the `Copy` menu, select `Copy as fetch`
7. Navigate to the `Console` and paste the request
8. Press `Enter`

### Explanation

The issue here is a failure to properly use the authentication. When you look at the coding challenge, you can see that the code grabs the user's information from the request (I believe by using the cookie as authentication), and that information is not used as validation. Therefore, a bad actor can pretend to be another user simply by changing the email that is sent in the request.

### Patch

I would patch the vulnerability by ensuring that the review is only updated if the post id also cooresponds to the user that was authenticated from the request. Since the authentication is trusted, using it would ensure that an attacker couldn't forget update a review. Since the first object in a MongoDB update will filter by all items in the object, adding the email received from authenticating the user will add this ensurance.

### Patch code

```
5	-	      { _id: req.body.id },
5	+	      { _id: req.body.id, author: user.data.email },
```

---

## Login Admin

### Exploit steps

1. List your (exact) steps here

### Explanation

In your own words, write a couple sentences about why this code is vulnerable. _(Keep to 200 words or less; preferably much less.)_

### Patch

In your own words, explain how would patch this vulnerability. _(Keep to 200 words or less; preferably much less.)_

### Patch code

Enter the patch code (only the changed lines)

---

## Admin Section

### Exploit steps

1. List your (exact) steps here

### Explanation

In your own words, write a couple sentences about why this code is vulnerable. _(Keep to 200 words or less; preferably much less.)_

### Patch

In your own words, explain how would patch this vulnerability. _(Keep to 200 words or less; preferably much less.)_

### Patch code

Enter the patch code (only the changed lines)

---

## Admin Registration

### Exploit steps

1. List your (exact) steps here

### Explanation

In your own words, write a couple sentences about why this code is vulnerable. _(Keep to 200 words or less; preferably much less.)_

### Patch

In your own words, explain how would patch this vulnerability. _(Keep to 200 words or less; preferably much less.)_

### Patch code

Enter the patch code (only the changed lines)

---

## API-Only XSS

### Exploit steps

1. List your (exact) steps here

### Explanation

In your own words, write a couple sentences about why this code is vulnerable. _(Keep to 200 words or less; preferably much less.)_

### Patch

In your own words, explain how would patch this vulnerability. _(Keep to 200 words or less; preferably much less.)_

### Patch code

Enter the patch code (only the changed lines)
